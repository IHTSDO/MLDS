<div class="row">
	<div class="col-md-12">
		<div class="page-header">
			<span class="pull-right"><a href="#/pendingApplications">Back to Pending Applications</a></span>
			<h1> Application Review</h1>
		</div>
	</div>
	<div class="col-md-12 user-info">
		<p><strong>Issue No:</strong> {{application.applicationId}}</p>
		<ul class="nav nav-pills">
			<li><span ng-show="application.organizationName"><h4>{{application.organizationName}} - </span> {{application.name}}</h4></li>
			<li class="application-status"><p class="label label-success">{{'approval.state.'+application.approvalState | translate}}</li>
		</ul>
		<p> <strong>Application Date: {{application.submittedAt | date}}</strong> </p>
	</div>

	<div class="row">
		<div class="col-md-8">
				<div ng-include="'views/admin/applicationSummaryBlock.html'"></div>
		</div>
		<div class="col-md-4 well">
			<div ng-controller="ApplicationReviewComparisonSearchController">
				<div ng-hide="showComparisonLicensee">
					<!-- Search block -->
					<script type="text/ng-template" id="views/admin/applicationReviewLicenseeSearchTemplate.html">
						<div id="searchbox">
							<address>
								<h5>{{match.model.application.organizationName}} {{match.model.application.fullName}}</strong></h5>
								{{match.model.application.address}}<br>
								{{match.model.application.city}}, {{match.model.application.country}} <br>
								<strong>Usage Type:</strong> {{'licensee.type.'+match.model.application.type | translate}} - {{match.model.application.subType}}<br>
								<strong>Type of Agreement:</strong> {{'licensee.agreementType.'+match.model.application.commercialUsage.context.agreementType | translate}}
							</address>
						 </div>
					</script>


					<div class="input-group" id="application-search">

						<input type="text" ng-model="comparisonLicensee" placeholder="Search for existing Licensees" 
						typeahead="licensee as licensee.application.organizationName for licensee in getLicenseesMatching($viewValue)" 
						typeahead-loading="searchingLicensees"
						typeahead-template-url="views/admin/applicationReviewLicenseeSearchTemplate.html"
						typeahead-on-select="selectComparisonLicensee(licensee)" 
						class="form-control">
						<span class="input-group-addon"><i class="fa fa-search"></i></span>
					</div>

				</div>
				<div class="search-results" ng-show="showComparisonLicensee">
					<h3 >Search Results<button class="close btn-close" ng-click="showComparisonLicensee = false"><i class="fa fa-times"></i></button>
					</h3>
						<div ng-include="'views/admin/applicationSummaryBlock.html'"></div>
			
				</div>
			</div>

			<div>
				<alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</alert>

				<form name="notesForm" novalidate bs-validation >
					<div class="form-group">
						<div class="pull-right" ng-show="submitting"><i class="fa fa-spinner"></i></div>
						<label>Staff Notes</label>
						<textarea class="form-control" rows="10" required name="notesInternal" ng-model="application.notesInternal" auto-submit></textarea>
					</div>
				</form>
				<div>
					<a class="btn btn-success btn-block" ng-click="approveApplication()">Approve Application</a>
					<a class="btn btn-warning btn-block" ng-click="changeRequested()">Change Requested from Applicant</a>
					<a class="btn btn-warning btn-block" ng-click="reviewRequested()">Review Requested from Staff</a>
					<br><br>
					<a class="btn btn-danger btn-block" ng-click="rejectApplication()">Decline Application</a>
				</div>
			</div>


		</div>
	</div>
